<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Build Configuration | Demonstrate. Test. Approve.</title>
  <meta name="description" content="Probo website">

  <link rel="stylesheet" href="/assets/probo-fc8d7317de3982d04075583b960ddbcf.css">

  <link rel="icon" type="image/png" href="/assets/probo-sphere-32x32-b4993cac851d2d136767723e1ec461fb.png" />
  <link rel="canonical" href="http://probo.ci/docs/build/">
  
  <!-- Start of zivtech Zendesk Widget script -->
<script>/*<![CDATA[*/window.zEmbed||function(e,t){var n,o,d,i,s,a=[],r=document.createElement("iframe");window.zEmbed=function(){a.push(arguments)},window.zE=window.zE||window.zEmbed,r.src="javascript:false",r.title="",r.role="presentation",(r.frameElement||r).style.cssText="display: none",d=document.getElementsByTagName("script"),d=d[d.length-1],d.parentNode.insertBefore(r,d),i=r.contentWindow,s=i.document;try{o=s}catch(c){n=document.domain,r.src='javascript:var d=document.open();d.domain="'+n+'";void(0);',o=s}o.open()._l=function(){var o=this.createElement("script");n&&(this.domain=n),o.id="js-iframe-async",o.src=e,this.t=+new Date,this.zendeskHost=t,this.zEQueue=a,this.body.appendChild(o)},o.write('<body onload="document._l();">'),o.close()}("https://assets.zendesk.com/embeddable_framework/main.js","zivtech.zendesk.com");/*]]>*/</script>
<!-- End of zivtech Zendesk Widget script -->
  
</head>


  <body class="sidebar-page site">
    <div class="site-content">
      <header class="site-header">

    <div class="wrapper">

        <a id="simple-menu" href="#sidr">
            <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 29.1 22.4" enable-background="new 0 0 29.1 22.4" xml:space="preserve">
                <rect x="0.1" y="0" fill="#3C122C" width="25" height="3"/>
                <rect x="0.1" y="8.1" fill="#3C122C" width="25" height="3"/>
                <rect x="0.1" y="16.2" fill="#3C122C" width="25" height="3"/>
            </svg>
        </a>

        <div id="sidr" style="display:none">
            <ul>
                
                <li><a href="/docs">Documentation</a></li>
                
                <li><a href="/blog">Blog</a></li>
                
            </ul>
        </div>

        <h1 class="st"><a class="site-title" href="/"><img src="/assets/probo-logo-no-slogan-white-f1d96d1c4cdb72e79a97561473c99497.png" alt="Probo logo with name"></a></h1>

        <ul id="navigation">
            
            <li><a href="/docs">Documentation</a></li>
            
            <li><a href="/blog">Blog</a></li>
            
        </ul>

    </div>

</header>


      <div class="wrapper">

        <div id="sidebar-first">
          <h4><a href="/docs/" class="current">Getting Started</a> (for Beta testers)</h4>
          <ul>
	<li><a href="/docs/about/" >What is Probo?</a></li>
	<li><a href="/docs/github/" >Github Integration</a></li>
	<li><a href="/docs/stash/" >Stash Integration</a></li>
 	<!-- <li><a href="/docs/app/" >Probo App</a></li> -->
 	<li><a href="/docs/build/" class="current">Build Configuration (.probo.yaml)</a></li>
    <li><a href="/docs/uploader/" >Asset Uploader</a></li>
<!--	<li><a href="/docs/workflow/" >Probo Recommended Workflow</a></li> -->
	<li><a href="/docs/faq/" >Probo FAQ</a></li>
</ul>

        </div>

        <div class="page-content">
            <h2 id="build-configuration">Build Configuration</h2>

<p>Probo runs builds based on a <code>/.probo.yaml</code> file found in the root of your repository. You can task the Container Manager to run any number of build steps. Each step is a runnable plugin, and will get a status update sent to Github for the commit.</p>

<p>When the build runs, your source code for the commit that triggered the build is automatically available to you in the <code>$SRC_DIR</code> directory inside the container.</p>

<p>The .probo.yaml is split into a section for <strong>‘assets’</strong> and a section for <strong>‘steps’</strong>.</p>

<h3 id="assets">Assets</h3>

<p>Assets is where you indicate which assets to import into this build. These can be any assets that you’ve uploaded with the (Probo Uploader)[http://probo.ci/docs/uploader/].</p>

<p>For example, if you need to use a an asset you’ve uploaded with filename dev.sql.gz, start .probo.yaml file with:</p>

<div class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="l-Scalar-Plain">assets</span><span class="p-Indicator">:</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">dev.sql.gz</span></code></pre></div>

<h3 id="steps">Steps</h3>

<p>Steps are the commands to run for the build. These are typically steps for setting up a site and running tests. </p>

<p>Each step must have a <code>name</code>. The name of each step is the build context, and will get its own status updates.</p>

<p>Each step also has a <code>plugin</code>. The default plugin is <code>shell</code>.</p>

<p>Depending on the <code>plugin</code> you specify, you may have other parameters depending on the step plugin used. The shell plugin requires a parameter for ‘command’.</p>

<p>For example, a few steps using the ‘shell’ plugin:</p>

<div class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="l-Scalar-Plain">steps</span><span class="p-Indicator">:</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Run behat tests</span>
    <span class="l-Scalar-Plain">plugin</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">shell</span>
    <span class="l-Scalar-Plain">command</span><span class="p-Indicator">:</span> <span class="s">&#39;cd</span><span class="nv"> </span><span class="s">tests</span><span class="nv"> </span><span class="s">;</span><span class="nv"> </span><span class="s">composer</span><span class="nv"> </span><span class="s">install</span><span class="nv"> </span><span class="s">;</span><span class="nv"> </span><span class="s">bin/behat&#39;</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Another example test with default shell plugin</span>
    <span class="l-Scalar-Plain">command</span><span class="p-Indicator">:</span> <span class="s">&#39;echo</span><span class="nv"> </span><span class="s">&quot;Hello</span><span class="nv"> </span><span class="s">World!&quot;&#39;</span></code></pre></div>

<h4 id="available-variables">Available variables:</h4>

<p>You can use several variables within your <code>.probo.yaml</code> file.</p>

<ul>
  <li><code>$SRC_DIR</code> : The filepath which contains the code from your pull request.</li>
  <li><code>$ASSET_DIR</code> : The filepath which contains any assets you uploaded to your Probo project.</li>
  <li><code>$BUILD_ID</code> : The ID for the build.</li>
</ul>

<h3 id="sample-proboyaml-files">Sample <code>.probo.yaml</code> files:</h3>

<h4 id="developing-on-a-site-with-a-database">Developing on a site with a database.</h4>

<div class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="l-Scalar-Plain">assets</span><span class="p-Indicator">:</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">dev.sql.gz</span>
<span class="l-Scalar-Plain">steps</span><span class="p-Indicator">:</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Import the database</span>
    <span class="l-Scalar-Plain">command</span><span class="p-Indicator">:</span> <span class="s">&#39;gunzip</span><span class="nv"> </span><span class="s">-c</span><span class="nv"> </span><span class="s">$ASSET_DIR/dev.sql.gz</span><span class="nv"> </span><span class="s">|</span><span class="nv"> </span><span class="s">`mysql</span><span class="nv"> </span><span class="s">foo`</span><span class="nv"> </span><span class="s">;</span><span class="nv"> </span><span class="s">rm</span><span class="nv"> </span><span class="s">$ASSET_DIR/dev.sql.gz&#39;</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Move code in place</span>
    <span class="l-Scalar-Plain">command</span><span class="p-Indicator">:</span> <span class="s">&#39;mv</span><span class="nv"> </span><span class="s">$SRC_DIR</span><span class="nv"> </span><span class="s">/var/www/foo/code&#39;</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Run behat tests</span>
    <span class="l-Scalar-Plain">command</span><span class="p-Indicator">:</span> <span class="s">&#39;cd</span><span class="nv"> </span><span class="s">/var/www/foo/code/tests</span><span class="nv"> </span><span class="s">;</span><span class="nv"> </span><span class="s">composer</span><span class="nv"> </span><span class="s">install</span><span class="nv"> </span><span class="s">;</span><span class="nv"> </span><span class="s">bin/behat&#39;</span></code></pre></div>

<h4 id="developing-a-drupal-module">Developing a Drupal module.</h4>

<div class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="l-Scalar-Plain">steps</span><span class="p-Indicator">:</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Create a D7 site</span>
    <span class="l-Scalar-Plain">command</span><span class="p-Indicator">:</span> <span class="s">&quot;drush</span><span class="nv"> </span><span class="s">fec</span><span class="nv"> </span><span class="s">drupal7</span><span class="nv"> </span><span class="s">--json-config=&#39;{\&quot;settings_php.snippets\&quot;:</span><span class="nv"> </span><span class="s">[]}&#39;&quot;</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Add our module code</span>
    <span class="l-Scalar-Plain">command</span><span class="p-Indicator">:</span> <span class="s">&#39;cp</span><span class="nv"> </span><span class="s">-r</span><span class="nv"> </span><span class="s">$SRC_DIR</span><span class="nv"> </span><span class="s">/var/www/drupal7/webroot/sites/all/modules&#39;</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Enable our module, &#39;foo&#39;.</span>
    <span class="l-Scalar-Plain">command</span><span class="p-Indicator">:</span> <span class="s">&#39;drush</span><span class="nv"> </span><span class="s">--root=/var/www/drupal7/webroot</span><span class="nv"> </span><span class="s">en</span><span class="nv"> </span><span class="s">foo</span><span class="nv"> </span><span class="s">-y&#39;</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Fix permissions</span>
    <span class="l-Scalar-Plain">command</span><span class="p-Indicator">:</span> <span class="s">&#39;chown</span><span class="nv"> </span><span class="s">-R</span><span class="nv"> </span><span class="s">www-data:www-data</span><span class="nv"> </span><span class="s">/var/www/fetcherserver/webroot/sites/default/files&#39;</span></code></pre></div>

<h3 id="iterating-until-your-build-configuration-succeeds">Iterating until your build configuration succeeds:</h3>

<p>Create a new branch in git and add the new <code>.probo.yaml</code> file in the root of the repository. Create a new Pull Request for that branch. You should see your build steps running on the pull request.</p>

<p>Look at the build details in the Probo app. You can see the output from each step. The output often helps you see what went wrong.</p>

<p>Edit your <code>.probo.yaml</code> file and commit the changes. Commits to an open pull request will trigger a new build.</p>

<p>Once your build configuration is working, merge your pull request.</p>

        </div>

      </div>

    </div>
    <footer class="site-footer">
    <div class="footer-learn-more">
        <div class="wrapper">
            <p>To learn more and see Probo in action <a class="button request" href="#">Request a demo today</a></p>
            <div class="right">
                <a href="https://github.com/ProboCI/probo" title="Probo on Github" target="_blank"><i class="fa fa-github-alt"></i></a>
                <a href="https://twitter.com/ProboCI" title="Sweet Probo Tweets" target="_blank"><i class="fa fa-twitter"></i></a>
            </div>
        </div>
    </div>
    <div class="wrapper">
        <img src="/assets/probo-logo-bw-225-c0b62567ae4c7d40950f5c93a6dbeaea.png" alt='black and white probo logo' class='site-footer__logo'>
        <div class="right">
            <a href="/docs" title="Probo Documentation" >Documentation</a>
            <a href="/blog" title="Probo Blog" >Blog</a>
            <div class="copyright">&copy; 2015 Probo.ci</div>
        </div>
    </div>

</footer>

<div class="overlay"></div>

    <!-- This form is from MailChimp -->
<div id="mc_embed_signup" class="updates-form" style="display: none">
    <i class="fa fa-times-circle-o close-request"></i>
    <img src="/assets/probo-sphere-84e5d8bea7e96b87140c64989ae142fa.png" alt="Probo sphere logo" class='updates-form__background'>
    <form action="//zivtech.us1.list-manage.com/subscribe/post?u=a6b5ac96de7e7b9fbe11b2007&amp;id=1d3b5dbec7"
          method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate updates-form__form"
          target="_blank" novalidate>
        <h2>Notify Me!</h2>
        <p>Let me know when hosted Probo reaches Beta!</p>
        <div id="mc_embed_signup_scroll">
            <div style="position: absolute; left: -5000px;">
                <input type="text" name="b_a6b5ac96de7e7b9fbe11b2007_1d3b5dbec7" tabindex="-1" value="">
            </div>
            <div class="mc-field-group updates-form__group">
                <label for="mce-EMAIL" class="u-hidden focussable">Email Address</label>
                <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" placeholder="Email" required>
            </div>
            <input type="submit" value="Go!" name="subscribe" id="mc-embedded-subscribe" class="updates-form__submit">
        </div>
    </form>
</div>

    <a href="https://github.com/ProboCI/probo" class="github-banner"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"></a>

    <script src="/assets/probo-91fc304a1bf25a84396682f56768c49d.js"></script>
  </body>

</html>

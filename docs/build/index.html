<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta name="google-site-verification" content="mxk7-mw5Q4wVVctQb0ckocY0eVXeDnwWsQbLwjiwBJs" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Build Configuration | Demonstrate. Test. Approve.</title>
  <meta name="description" content="Probo website">

  <link rel="stylesheet" href="/assets/probo-6f61fdc5db750eac0d38bceb4def5b12.css">

  <link rel="icon" type="image/png" href="/assets/probo-sphere-32x32-dc1f9c30e28a337535dc46692b56459b.png" />
  <link rel="canonical" href="http://probo.ci/docs/build/">
  
</head>


  <body class="sidebar-page site">
    <div class="site-content">
      <header class="site-header">

    <div class="wrapper">

        <a id="simple-menu" href="#sidr">
            <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 29.1 22.4" enable-background="new 0 0 29.1 22.4" xml:space="preserve">
                <rect x="0.1" y="0" fill="#f7f4f8" width="25" height="3"/>
                <rect x="0.1" y="8.1" fill="#f7f4f8" width="25" height="3"/>
                <rect x="0.1" y="16.2" fill="#f7f4f8" width="25" height="3"/>
            </svg>
        </a>

        <div id="sidr" style="display:none">
            <ul>
                
                <li><a href="/product">Product</a></li>
                
                <li><a href="/about">About</a></li>
                
                <li><a href="/blog">Blog</a></li>
                
                <li><a href="/docs">Docs</a></li>
                
                <li class="login"><a href="https://app.probo.ci/" target="_blank"><i class="fa fa-cog">&nbsp;</i>Login</a>
            </ul>
        </div>

        <h1 class="st"><a class="site-title" href="/"><img src="/assets/probo-logo-no-slogan-white-0f20b1bcda3fec1e9cf49de966579637.png" alt="Probo logo with name"></a></h1>

        <ul id="navigation">
            
            <li><a href="/product">Product</a></li>
            
            <li><a href="/about">About</a></li>
            
            <li><a href="/blog">Blog</a></li>
            
            <li><a href="/docs">Docs</a></li>
            
            <li class="login"><a href="https://app.probo.ci/" target="_blank"><i class="fa fa-cog">&nbsp;</i>Login</a>
        </ul>

    </div>

</header>


      <div class="wrapper">

        <header class="page-header">
          <h1 class="post-title">Docs</h1>
        </header>

        <div id="sidebar-first">
          <ul>
	<li><a href="/docs/app/" >Using the Probo App</a></li>
	<li><a href="/docs/github/" >Github Integration</a></li>
	<li><a href="/docs/stash/" >Stash Integration</a></li>
	<li><a href="/docs/build/" class="current">Build Configuration</a></li>
	<li><a href="/docs/uploader/" >Uploading Build Assets to Probo</a></li>
</ul>

        </div>

        <div class="page-content">
          <h1 class="page-title">Build Configuration</h1>
          <p>Probo runs builds based on a <code>/.probo.yaml</code> file found in the root of your repository. You can task the Container Manager to run any number of build steps. Each step is a runnable plugin, and will get a status update sent to GitHub for the commit.</p>

<p>When the build runs, your source code for the commit that triggered the build is automatically available to you in the <code>$SRC_DIR</code> directory inside the container.</p>

<p>The .probo.yaml is split into a section for <strong>‘assets’</strong> and a section for <strong>‘steps’</strong>.</p>

<h2 id="assets">Assets</h2>

<p>Assets is where you indicate which assets to import into this build. These can be any assets that you’ve uploaded with the <a href="http://probo.ci/docs/uploader/">Probo Uploader</a>.</p>

<p>For example, if you need to use a an asset you’ve uploaded with filename dev.sql.gz, start .probo.yaml file with:</p>

<div class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="l-Scalar-Plain">assets</span><span class="p-Indicator">:</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">dev.sql.gz</span></code></pre></div>

<h2 id="steps">Steps</h2>

<p>Steps are the commands to run for the build. These are typically steps for setting up a site and running tests. </p>

<p>Each step must have a <code>name</code>. The name of each step is the build context, and will get its own status updates.</p>

<h3 id="plugins">Plugins</h3>

<p>Each step also has a <code>Plugin</code>. The default Plugin is <code>Shell</code>.  Depending on the <code>Plugin</code> you specify, you will have access to various parameters. These parameters allow you to configure your Probo site build.</p>

<p><strong>Please Note:</strong> Currently, Plugin names are case sensitive. This means that <code>shell</code> will not work.</p>

<h4 id="shell-plugin">1. Shell Plugin</h4>

<p>The Shell plugin requires a parameter for <code>command</code>. This allows you to define Shell commands to run during the site build. You can list as many commands as you like within the steps in your .probo.yaml file. Remember to include a <code>name</code> for each <code>command</code>.</p>

<p>The Shell plugin provides several variables to use within your <code>.probo.yaml</code> file.</p>

<table>
  <thead>
    <tr>
      <th>Available Variables</th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>$SRC_DIR</code></td>
      <td>The filepath which contains the code from your pull request.</td>
    </tr>
    <tr>
      <td><code>$ASSET_DIR</code></td>
      <td>The filepath which contains any assets you uploaded to your Probo project.</td>
    </tr>
    <tr>
      <td><code>$BUILD_ID</code></td>
      <td>The ID for the build.</td>
    </tr>
  </tbody>
</table>

<h5 id="examples">Examples</h5>

<h6 id="using-the-shell-plugin">Using the <code>Shell</code> plugin</h6>

<div class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="l-Scalar-Plain">steps</span><span class="p-Indicator">:</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Run behat tests</span>
    <span class="l-Scalar-Plain">plugin</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Shell</span>
    <span class="l-Scalar-Plain">command</span><span class="p-Indicator">:</span> <span class="s">&#39;cd</span><span class="nv"> </span><span class="s">tests</span><span class="nv"> </span><span class="s">;</span><span class="nv"> </span><span class="s">composer</span><span class="nv"> </span><span class="s">install</span><span class="nv"> </span><span class="s">;</span><span class="nv"> </span><span class="s">bin/behat&#39;</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Another example test with default Shell plugin</span>
    <span class="l-Scalar-Plain">command</span><span class="p-Indicator">:</span> <span class="s">&#39;echo</span><span class="nv"> </span><span class="s">&quot;Hello</span><span class="nv"> </span><span class="s">World!&quot;&#39;</span></code></pre></div>

<h6 id="developing-on-a-site-with-a-database">Developing on a site with a database:</h6>

<div class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="l-Scalar-Plain">assets</span><span class="p-Indicator">:</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">dev.sql.gz</span>
<span class="l-Scalar-Plain">steps</span><span class="p-Indicator">:</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">plugin</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Shell</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Import the database</span>
    <span class="l-Scalar-Plain">command</span><span class="p-Indicator">:</span> <span class="s">&#39;gunzip</span><span class="nv"> </span><span class="s">-c</span><span class="nv"> </span><span class="s">$ASSET_DIR/dev.sql.gz</span><span class="nv"> </span><span class="s">|</span><span class="nv"> </span><span class="s">`mysql</span><span class="nv"> </span><span class="s">foo`</span><span class="nv"> </span><span class="s">;</span><span class="nv"> </span><span class="s">rm</span><span class="nv"> </span><span class="s">$ASSET_DIR/dev.sql.gz&#39;</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Move code in place</span>
    <span class="l-Scalar-Plain">command</span><span class="p-Indicator">:</span> <span class="s">&#39;mv</span><span class="nv"> </span><span class="s">$SRC_DIR</span><span class="nv"> </span><span class="s">/var/www/foo/code&#39;</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Run behat tests</span>
    <span class="l-Scalar-Plain">command</span><span class="p-Indicator">:</span> <span class="s">&#39;cd</span><span class="nv"> </span><span class="s">/var/www/foo/code/tests</span><span class="nv"> </span><span class="s">;</span><span class="nv"> </span><span class="s">composer</span><span class="nv"> </span><span class="s">install</span><span class="nv"> </span><span class="s">;</span><span class="nv"> </span><span class="s">bin/behat&#39;</span></code></pre></div>

<h4 id="drupal-plugin">2. Drupal Plugin</h4>

<p>The Drupal plugin provides parameters for your build steps if you are using Probo for a Drupal site. </p>

<h5 id="available-parameters">Available Parameters</h5>

<table>
  <thead>
    <tr>
      <th>Directory Configuration</th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>makeFile</code></td>
      <td>The name of the <a href="http://www.drush.org/en/master/make/">Drush make file</a> to run to generate                             the install directory. Accepts a <strong>string</strong> value.</td>
    </tr>
    <tr>
      <td><code>profileName</code></td>
      <td>The profile name used in creating a symlink to this directory if a Drush make file is                                  specified with the <code>makeFile</code> option and used to select the profile to install if the <code>runInstall</code>                             option is selected. Accepts a <strong>string</strong> value.</td>
    </tr>
    <tr>
      <td><code>runInstall</code></td>
      <td>If set, run <code>drush site-install</code> to perform a fresh install of the site using the                                      <code>profileName</code> as the install profile and allowing the <code>installArgs</code> option to configure the                                    install. Accepts a <strong>boolean</strong> value.&lt;/i&gt;/ul&gt;</td>
    </tr>
    <tr>
      <td><code>installArgs</code></td>
      <td>A set of parameters to concatenate onto the <code>drush site-install</code> command if the                                        <code>runInstall</code> option is set. Defaults to ‘’. Accepts a <strong>string</strong> value.</td>
    </tr>
    <tr>
      <td><code>siteFolder</code></td>
      <td>Specifies the site folder to use for this build (the folder within the Drupal <code>sites</code>                                  folder). Defaults to <code>default</code>. Accepts a <strong>string</strong> value.</td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th>Database Configuration</th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>database</code></td>
      <td>The name of the database to import if specified. Note that this database <em>must be added as                             an asset separately</em>. Accepts a <strong>string</strong> value.</td>
    </tr>
    <tr>
      <td><code>databaseGzipped</code></td>
      <td>Whether the database was sent gzipped and whether it should therefore be gunzipped before                               importing. Accepts a <strong>boolean</strong> value.</td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th>Additional Options</th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>databaseUpdates</code></td>
      <td>Determines whether to run <code>drush updb</code> after the build is finished. Accepts a                                  <strong>boolean</strong> value.</td>
    </tr>
    <tr>
      <td><code>clearCaches</code></td>
      <td>Whether to clear all caches after the build is finished. Defaults to                                           true. Accepts a <strong>boolean</strong> value.</td>
    </tr>
    <tr>
      <td><code>revertFeatures</code></td>
      <td>Whether to revert features using <code>drush fra</code> after the build is finished. Accepts a                             <strong>boolean</strong> value.</td>
    </tr>
  </tbody>
</table>

<h5 id="examples-1">Examples</h5>

<h6 id="using-the-drupal-plugin">Using the <code>Drupal</code> plugin</h6>

<div class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="l-Scalar-Plain">assets</span><span class="p-Indicator">:</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">mydb.sql.gz</span>
<span class="l-Scalar-Plain">steps</span><span class="p-Indicator">:</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Probo site setup</span>
    <span class="l-Scalar-Plain">plugin</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Drupal</span>
    <span class="l-Scalar-Plain">database</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">mydb.sql.gz</span>
    <span class="l-Scalar-Plain">databaseGzipped</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">true</span>
    <span class="l-Scalar-Plain">databaseUpdates</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">true</span>
    <span class="l-Scalar-Plain">revertFeatures</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">true</span></code></pre></div>

<h2 id="iterating-until-your-build-configuration-succeeds">Iterating until your build configuration succeeds:</h2>

<p>Create a new branch in git and add the new <code>.probo.yaml</code> file in the root of the repository. Create a new Pull Request for that branch. You should see your build steps running on the pull request.</p>

<p>Look at the build details in the Probo app. You can see the output from each step. The output often helps you see what went wrong.</p>

<p>Edit your <code>.probo.yaml</code> file and commit the changes. Commits to an open pull request will trigger a new build.</p>

<p>Once your build configuration is working, merge your pull request.</p>

        </div>

      </div>

    </div>
    <footer class="site-footer">
    <div class="footer-learn-more">
        <div class="wrapper">
            <p>To learn more and see Probo in action <a class="button request" href="#">Request a demo today</a></p>
            <div class="right">
                <a href="https://github.com/ProboCI/probo" title="Probo on Github" target="_blank"><i class="fa fa-github-alt"></i></a>
                <a href="https://twitter.com/ProboCI" title="Sweet Probo Tweets" target="_blank"><i class="fa fa-twitter"></i></a>
            </div>
        </div>
    </div>
    <div class="wrapper">
        <img src="/assets/probo-logo-bw-225-d1d5b8ef607435e1e310dc7c16f66fdb.png" alt='black and white probo logo' class='site-footer__logo'>
        <div class="right">
            <a href="/docs" title="Probo Documentation" >Documentation</a>
            <a href="/blog" title="Probo Blog" >Blog</a>
            <a href="https://app.probo.ci/" target="_blank">Login</a>
            <div class="copyright">&copy; 2015 Probo.ci</div>
        </div>
    </div>

</footer>

<div class="overlay"></div>

    <!-- This form is from MailChimp -->
<div id="mc_embed_signup" class="updates-form" style="display: none">
    <i class="fa fa-times-circle-o close-request"></i>
    <img src="/assets/probo-sphere-8f8d00c0853ce6dbdefbaaf7566491f8.png" alt="Probo sphere logo" class='updates-form__background'>
    <form action="//zivtech.us1.list-manage.com/subscribe/post?u=a6b5ac96de7e7b9fbe11b2007&amp;id=1d3b5dbec7"
          method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate updates-form__form"
          target="_blank" novalidate>
        <h2>Notify Me!</h2>
        <p>Let me know when hosted Probo reaches Beta!</p>
        <div id="mc_embed_signup_scroll">
            <div style="position: absolute; left: -5000px;">
                <input type="text" name="b_a6b5ac96de7e7b9fbe11b2007_1d3b5dbec7" tabindex="-1" value="">
            </div>
            <div class="mc-field-group updates-form__group">
                <label for="mce-EMAIL" class="u-hidden focussable">Email Address</label>
                <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" placeholder="Email" required>
            </div>
            <input type="submit" value="Go!" name="subscribe" id="mc-embedded-subscribe" class="updates-form__submit">
        </div>
    </form>
</div>

    <a href="https://github.com/ProboCI/probo" class="github-banner"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"></a>

    <script src="/assets/probo-79be44af8ed5b6149eea9c4a74d91a3e.js"></script>
  </body>

</html>
